/*! For license information please see main.js.LICENSE.txt */
(()=>{"use strict";var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},t(e,r)};function e(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}var r=function(){return r=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)};function n(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function o(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}function i(t,e){for(var r=0,n=e.length,o=t.length;r<n;r++,o++)t[o]=e[r];return t}function s(t){return"function"==typeof t}function u(t){var e=t((function(t){Error.call(t),t.stack=(new Error).stack}));return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}Object.create,Object.create;var a=u((function(t){return function(e){t(this),this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map((function(t,e){return e+1+") "+t.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e}}));function c(t,e){if(t){var r=t.indexOf(e);0<=r&&t.splice(r,1)}}var l=function(){function t(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._teardowns=null}var e;return t.prototype.unsubscribe=function(){var t,e,r,u,c;if(!this.closed){this.closed=!0;var l=this._parentage;if(l)if(this._parentage=null,Array.isArray(l))try{for(var d=n(l),h=d.next();!h.done;h=d.next())h.value.remove(this)}catch(e){t={error:e}}finally{try{h&&!h.done&&(e=d.return)&&e.call(d)}finally{if(t)throw t.error}}else l.remove(this);var p=this.initialTeardown;if(s(p))try{p()}catch(t){c=t instanceof a?t.errors:[t]}var v=this._teardowns;if(v){this._teardowns=null;try{for(var y=n(v),b=y.next();!b.done;b=y.next()){var m=b.value;try{f(m)}catch(t){c=null!=c?c:[],t instanceof a?c=i(i([],o(c)),o(t.errors)):c.push(t)}}}catch(t){r={error:t}}finally{try{b&&!b.done&&(u=y.return)&&u.call(y)}finally{if(r)throw r.error}}}if(c)throw new a(c)}},t.prototype.add=function(e){var r;if(e&&e!==this)if(this.closed)f(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._teardowns=null!==(r=this._teardowns)&&void 0!==r?r:[]).push(e)}},t.prototype._hasParent=function(t){var e=this._parentage;return e===t||Array.isArray(e)&&e.includes(t)},t.prototype._addParent=function(t){var e=this._parentage;this._parentage=Array.isArray(e)?(e.push(t),e):e?[e,t]:t},t.prototype._removeParent=function(t){var e=this._parentage;e===t?this._parentage=null:Array.isArray(e)&&c(e,t)},t.prototype.remove=function(e){var r=this._teardowns;r&&c(r,e),e instanceof t&&e._removeParent(this)},t.EMPTY=((e=new t).closed=!0,e),t}();function d(t){return t instanceof l||t&&"closed"in t&&s(t.remove)&&s(t.add)&&s(t.unsubscribe)}function f(t){s(t)?t():t.unsubscribe()}l.EMPTY;var h=function(t){function r(e,r){return t.call(this)||this}return e(r,t),r.prototype.schedule=function(t,e){return void 0===e&&(e=0),this},r}(l),p={setInterval:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=p.delegate;return((null==r?void 0:r.setInterval)||setInterval).apply(void 0,i([],o(t)))},clearInterval:function(t){var e=p.delegate;return((null==e?void 0:e.clearInterval)||clearInterval)(t)},delegate:void 0},v=function(t){function r(e,r){var n=t.call(this,e,r)||this;return n.scheduler=e,n.work=r,n.pending=!1,n}return e(r,t),r.prototype.schedule=function(t,e){if(void 0===e&&(e=0),this.closed)return this;this.state=t;var r=this.id,n=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(n,r,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(n,this.id,e),this},r.prototype.requestAsyncId=function(t,e,r){return void 0===r&&(r=0),p.setInterval(t.flush.bind(t,this),r)},r.prototype.recycleAsyncId=function(t,e,r){if(void 0===r&&(r=0),null!=r&&this.delay===r&&!1===this.pending)return e;p.clearInterval(e)},r.prototype.execute=function(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var r=this._execute(t,e);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},r.prototype._execute=function(t,e){var r,n=!1;try{this.work(t)}catch(t){n=!0,r=t||new Error("Scheduled action threw falsy error")}if(n)return this.unsubscribe(),r},r.prototype.unsubscribe=function(){if(!this.closed){var e=this.id,r=this.scheduler,n=r.actions;this.work=this.state=this.scheduler=null,this.pending=!1,c(n,this),null!=e&&(this.id=this.recycleAsyncId(r,e,null)),this.delay=null,t.prototype.unsubscribe.call(this)}},r}(h),y={now:function(){return(y.delegate||Date).now()},delegate:void 0},b=function(){function t(e,r){void 0===r&&(r=t.now),this.schedulerActionCtor=e,this.now=r}return t.prototype.schedule=function(t,e,r){return void 0===e&&(e=0),new this.schedulerActionCtor(this,t).schedule(r,e)},t.now=y.now,t}(),m=new(function(t){function r(e,r){void 0===r&&(r=b.now);var n=t.call(this,e,r)||this;return n.actions=[],n._active=!1,n._scheduled=void 0,n}return e(r,t),r.prototype.flush=function(t){var e=this.actions;if(this._active)e.push(t);else{var r;this._active=!0;do{if(r=t.execute(t.state,t.delay))break}while(t=e.shift());if(this._active=!1,r){for(;t=e.shift();)t.unsubscribe();throw r}}},r}(b))(v),w=m,g=null,_=null,x=void 0,T=!1,S=!1,E={setTimeout:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=E.delegate;return((null==r?void 0:r.setTimeout)||setTimeout).apply(void 0,i([],o(t)))},clearTimeout:function(t){var e=E.delegate;return((null==e?void 0:e.clearTimeout)||clearTimeout)(t)},delegate:void 0};function O(t){E.setTimeout((function(){if(!g)throw t;g(t)}))}function j(){}var P=A("C",void 0,void 0);function A(t,e,r){return{kind:t,value:e,error:r}}var C=null;function D(t){T&&C&&(C.errorThrown=!0,C.error=t)}var L=function(t){function r(e){var r=t.call(this)||this;return r.isStopped=!1,e?(r.destination=e,d(e)&&e.add(r)):r.destination=U,r}return e(r,t),r.create=function(t,e,r){return new R(t,e,r)},r.prototype.next=function(t){this.isStopped?q(function(t){return A("N",t,void 0)}(t),this):this._next(t)},r.prototype.error=function(t){this.isStopped?q(A("E",void 0,t),this):(this.isStopped=!0,this._error(t))},r.prototype.complete=function(){this.isStopped?q(P,this):(this.isStopped=!0,this._complete())},r.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this),this.destination=null)},r.prototype._next=function(t){this.destination.next(t)},r.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},r.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},r}(l),R=function(t){function r(e,r,n){var o,i=t.call(this)||this;if(s(e))o=e;else if(e){var u;o=e.next,r=e.error,n=e.complete,i&&S?(u=Object.create(e)).unsubscribe=function(){return i.unsubscribe()}:u=e,o=null==o?void 0:o.bind(u),r=null==r?void 0:r.bind(u),n=null==n?void 0:n.bind(u)}return i.destination={next:o?I(o):j,error:I(null!=r?r:k),complete:n?I(n):j},i}return e(r,t),r}(L);function I(t,e){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];try{t.apply(void 0,i([],o(e)))}catch(t){T?D(t):O(t)}}}function k(t){throw t}function q(t,e){var r=_;r&&E.setTimeout((function(){return r(t,e)}))}var U={closed:!0,next:j,error:k,complete:j},$="function"==typeof Symbol&&Symbol.observable||"@@observable";function H(t){return t}function M(t){return 0===t.length?H:1===t.length?t[0]:function(e){return t.reduce((function(t,e){return e(t)}),e)}}var N=function(){function t(t){t&&(this._subscribe=t)}return t.prototype.lift=function(e){var r=new t;return r.source=this,r.operator=e,r},t.prototype.subscribe=function(t,e,r){var n,o=this,i=(n=t)&&n instanceof L||function(t){return t&&s(t.next)&&s(t.error)&&s(t.complete)}(n)&&d(n)?t:new R(t,e,r);return function(t){if(T){var e=!C;if(e&&(C={errorThrown:!1,error:null}),t(),e){var r=C,n=r.errorThrown,o=r.error;if(C=null,n)throw o}}else t()}((function(){var t=o,e=t.operator,r=t.source;i.add(e?e.call(i,r):r?o._subscribe(i):o._trySubscribe(i))})),i},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){t.error(e)}},t.prototype.forEach=function(t,e){var r=this;return new(e=F(e))((function(e,n){var o;o=r.subscribe((function(e){try{t(e)}catch(t){n(t),null==o||o.unsubscribe()}}),n,e)}))},t.prototype._subscribe=function(t){var e;return null===(e=this.source)||void 0===e?void 0:e.subscribe(t)},t.prototype[$]=function(){return this},t.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return M(t)(this)},t.prototype.toPromise=function(t){var e=this;return new(t=F(t))((function(t,r){var n;e.subscribe((function(t){return n=t}),(function(t){return r(t)}),(function(){return t(n)}))}))},t.create=function(e){return new t(e)},t}();function F(t){var e;return null!==(e=null!=t?t:x)&&void 0!==e?e:Promise}class B{constructor(t){this.server=t,this.messagees=document.querySelector(".messages"),this.currentTime=(new Date).getTime()}startUpdate(){var t,e;(t=1e4,void 0===t&&(t=0),void 0===e&&(e=m),t<0&&(t=0),function(t,e,r){void 0===t&&(t=0),void 0===r&&(r=w);var n,o=-1;return null!=e&&((n=e)&&s(n.schedule)?r=e:o=e),new N((function(e){var n=function(t){return t instanceof Date&&!isNaN(t)}(t)?+t-r.now():t;n<0&&(n=0);var i=0;return r.schedule((function(){e.closed||(e.next(i++),0<=o?this.schedule(void 0,o):e.complete())}),n)}))}(t,t,e)).subscribe((()=>this.responseMessages()))}async responseMessages(){(await this.server.ajaxRx()).subscribe((t=>{t.messages.forEach((t=>{t.received>this.currentTime&&this.render(t)})),this.currentTime=(new Date).getTime()}),(t=>console.log(t.message)))}render(t){const e=document.createElement("div"),r=document.createElement("div"),n=document.createElement("div"),o=document.createElement("div");e.classList.add("new-message"),r.textContent=t.from,r.style.width="45%",e.appendChild(r),t.subject.length>15?n.textContent=`${t.subject.slice(0,14)}...`:n.textContent=t.subject,e.appendChild(n),o.textContent=B.getDate(t.received),e.appendChild(o),this.messagees.insertBefore(e,this.messagees.children[0])}static getDate(t){const e=new Date(t).getFullYear();let r=new Date(t).getMonth()+1,n=new Date(t).getDate(),o=new Date(t).getHours(),i=new Date(t).getMinutes();return 1===String(r).length&&(r=`0${r}`),1===String(n).length&&(n=`0${n}`),1===String(i).length&&(i=`0${i}`),1===String(o).length&&(o=`0${o}`),`${o}:${i} ${n}.${r}.${String(e).slice(2)}`}}var X=function(t){function r(e,r,n,o,i){var s=t.call(this,e)||this;return s.onFinalize=i,s._next=r?function(t){try{r(t)}catch(t){e.error(t)}}:t.prototype._next,s._error=o?function(t){try{o(t)}catch(t){e.error(t)}finally{this.unsubscribe()}}:t.prototype._error,s._complete=n?function(){try{n()}catch(t){e.error(t)}finally{this.unsubscribe()}}:t.prototype._complete,s}return e(r,t),r.prototype.unsubscribe=function(){var e,r=this.closed;t.prototype.unsubscribe.call(this),!r&&(null===(e=this.onFinalize)||void 0===e||e.call(this))},r}(L);function J(t){switch(t.responseType){case"json":if("response"in t)return t.response;var e=t;return JSON.parse(e.responseText);case"document":return t.responseXML;default:return"response"in t?t.response:(e=t).responseText}}var G=function(t,e,r,n){void 0===n&&(n="download_load"),this.originalEvent=t,this.xhr=e,this.request=r,this.type=n;var o=e.status,i=e.responseType;this.status=null!=o?o:0,this.responseType=null!=i?i:"";var s=e.getAllResponseHeaders();this.responseHeaders=s?s.split("\n").reduce((function(t,e){var r=e.indexOf(": ");return t[e.slice(0,r)]=e.slice(r+2),t}),{}):{},this.response=J(e);var u=t.loaded,a=t.total;this.loaded=u,this.total=a},Y=u((function(t){return function(t,e,r){var n;this.message=t,this.name="AjaxError",this.xhr=e,this.request=r,this.status=e.status,this.responseType=e.responseType;try{n=J(e)}catch(t){n=e.responseText}this.response=n}})),z=function(){function t(t,e){return Y.call(this,"ajax timeout",t,e),this.name="AjaxTimeoutError",this}return t.prototype=Object.create(Y.prototype),t}();var V,K,Q=(V=function(t){return t.response},K=function(t,e){var r=0;t.subscribe(new X(e,(function(t){e.next(V.call(void 0,t,r++))})))},function(t){if(function(t){return s(null==t?void 0:t.lift)}(t))return t.lift((function(t){try{return K(t,this)}catch(t){this.error(t)}}));throw new TypeError("Unable to lift unknown Observable type")});var W,Z=(W=function(t){return function(t){return new N((function(e){var n,o,i,s=t.queryParams,u=t.body,a=t.headers,c=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]])}return r}(t,["queryParams","body","headers"]),l=c.url;if(!l)throw new TypeError("url is required");if(s)if(l.includes("?")){var d=l.split("?");if(2<d.length)throw new TypeError("invalid url");i=new URLSearchParams(d[1]),new URLSearchParams(s).forEach((function(t,e){return i.set(e,t)})),l=d[0]+"?"+i}else l=l+"?"+(i=new URLSearchParams(s));var f={};if(a)for(var h in a)a.hasOwnProperty(h)&&(f[h.toLowerCase()]=a[h]);t.crossDomain||"x-requested-with"in f||(f["x-requested-with"]="XMLHttpRequest");var p=c.withCredentials,v=c.xsrfCookieName,y=c.xsrfHeaderName;if((p||!c.crossDomain)&&v&&y){var b=null!==(o=null===(n=null===document||void 0===document?void 0:document.cookie.match(new RegExp("(^|;\\s*)("+v+")=([^;]*)")))||void 0===n?void 0:n.pop())&&void 0!==o?o:"";b&&(f[y]=b)}var m,w=function(t,e){var r;if(!t||"string"==typeof t||function(t){return"undefined"!=typeof FormData&&t instanceof FormData}(t)||function(t){return"undefined"!=typeof URLSearchParams&&t instanceof URLSearchParams}(t)||function(t){return st(t,"ArrayBuffer")}(t)||function(t){return st(t,"File")}(t)||function(t){return st(t,"Blob")}(t)||function(t){return"undefined"!=typeof ReadableStream&&t instanceof ReadableStream}(t))return t;if(function(t){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView(t)}(t))return t.buffer;if("object"==typeof t)return e["content-type"]=null!==(r=e["content-type"])&&void 0!==r?r:"application/json;charset=utf-8",JSON.stringify(t);throw new TypeError("Unknown body type")}(u,f),g=r(r({async:!0,crossDomain:!0,withCredentials:!1,method:"GET",timeout:0,responseType:"json"},c),{url:l,headers:f,body:w});m=t.createXHR?t.createXHR():new XMLHttpRequest;var _=t.progressSubscriber,x=t.includeDownloadProgress,T=void 0!==x&&x,S=t.includeUploadProgress,E=void 0!==S&&S,O=function(t,r){m.addEventListener(t,(function(){var t,n=r();null===(t=null==_?void 0:_.error)||void 0===t||t.call(_,n),e.error(n)}))};O("timeout",(function(){return new z(m,g)})),O("abort",(function(){return new Y("aborted",m,g)}));var j=function(t,e){return new G(e,m,g,t+"_"+e.type)},P=function(t,r,n){t.addEventListener(r,(function(t){e.next(j(n,t))}))};E&&[rt,nt,ot].forEach((function(t){return P(m.upload,t,tt)})),_&&[rt,nt].forEach((function(t){return m.upload.addEventListener(t,(function(t){var e;return null===(e=null==_?void 0:_.next)||void 0===e?void 0:e.call(_,t)}))})),T&&[rt,nt].forEach((function(t){return P(m,t,et)}));var A=function(t){var r="ajax error"+(t?" "+t:"");e.error(new Y(r,m,g))};m.addEventListener("error",(function(t){var e;null===(e=null==_?void 0:_.error)||void 0===e||e.call(_,t),A()})),m.addEventListener(ot,(function(t){var r,n,o=m.status;if(o<400){null===(r=null==_?void 0:_.complete)||void 0===r||r.call(_);var i=void 0;try{i=j(et,t)}catch(t){return void e.error(t)}e.next(i),e.complete()}else null===(n=null==_?void 0:_.error)||void 0===n||n.call(_,t),A(o)}));var C=g.user,D=g.method,L=g.async;for(var h in C?m.open(D,l,L,C,g.password):m.open(D,l,L),L&&(m.timeout=g.timeout,m.responseType=g.responseType),"withCredentials"in m&&(m.withCredentials=g.withCredentials),f)f.hasOwnProperty(h)&&m.setRequestHeader(h,f[h]);return w?m.send(w):m.send(),function(){m&&4!==m.readyState&&m.abort()}}))}("string"==typeof t?{url:t}:t)},W.get=function(t,e){return Z({method:"GET",url:t,headers:e})},W.post=function(t,e,r){return Z({method:"POST",url:t,body:e,headers:r})},W.delete=function(t,e){return Z({method:"DELETE",url:t,headers:e})},W.put=function(t,e,r){return Z({method:"PUT",url:t,body:e,headers:r})},W.patch=function(t,e,r){return Z({method:"PATCH",url:t,body:e,headers:r})},W.getJSON=function(t,e){return Q(Z({method:"GET",url:t,headers:e}))},W),tt="upload",et="download",rt="loadstart",nt="progress",ot="load",it=Object.prototype.toString;function st(t,e){return it.call(t)==="[object "+e+"]"}console.log("app started");const ut=new class{constructor(){this.url="https://bombik815-http.herokuapp.com"}ajaxRx(){return Z.getJSON(`${this.url}/messages/unread`)}};new B(ut).startUpdate()})();